<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content=
"text/html; charset=iso-8859-15">
<title>OnlineDict 选项页</title>
<link rel="stylesheet" type="text/css" href="options.css">
</head>
<body>
<div id="main_container">
<h1><img src="logo.png" width="30" />OnlineDict 单词记忆助手</h1>

<table cellpadding="5" class="settings-table">
<tr><td valign="top" width="75%">您最近查看的生词：<input type="button" value="上一页" onclick="ShowPrev()"/><input type="button" value="下一页"  onclick="ShowNext()"/>
<div id="itemcount" align="right">共N条</div>
<div id="div_words" ></div>
</td>
<td valign="top">
<div id="div_finished" >您已经记住了以下单词：</div>
</td>
</tr>
</table>
<script type="text/javascript" src="lookup.js"></script>
<script type="text/javascript" src="newwords.js"></script>
<script> 
var range = DBGetRange();
var currentpage = GetPageCount();
ShowPage(currentpage);


function GetPageCount()
{
    var itemcount = range["itemCount"];
    if(itemcount<=0)
    {
        return 0;
    }
    var flr = Math.floor(itemcount/7);
    if(0==itemcount%7)
    {
        flr -= 1;
    }
    return flr;
}

function SetRemember(id)
{
  DBSetRemember(id);
  
  document.getElementById("div_newword_" + id).style.display = "none";
  AddRememberItem(id);
}
function AddRememberItem(i)
{
    var div = document.createElement("div");
    div.id = "div_finish_" + i;
    div.style.background = '#cfc';
    div.innerHTML= DBGetItem(i)[1];
    document.getElementById("div_finished").appendChild(div);
}
function ShowItem(idBgn,count)
{
    var wordHtm = "";
    document.getElementById("div_words").innerHTML = "";
    for(var i=idBgn+count-1;i>=idBgn;i--)
    {
      if(range["itemCount"] <= i)
      {
        continue;
      }
      var item = DBGetItem(i);
      if(!item)
      {
        continue;
      }
      //alert(item);
      if(item[3]==0)
      {
        var div = document.createElement("div");
        div.id = "div_newword_" + i;
        if(i%2==0)
        {
          div.style.background = '#cec';
        }
        var reg = new RegExp(item[1],"gim");
        var newWord = "<bond><font color=red>" + item[1] + "</font><bond>";
        if(!item[2])
        {
            item[2] = "(empty)";
        }
        div.innerHTML= (i+1) + ". "+ item[1] 
        + "<input type='button' value='记住了' onclick='jscript:SetRemember(" +  i + ");'/>"
        + "<p>例句：" + item[2].replace(reg,newWord) + "</p>"; 
        document.getElementById("div_words").appendChild(div);
        
      }
      else if(item[3]==1)
      {
        var div = document.createElement("div");
        div.id = "div_newword_" + i;
        div.style.background = '#cfc';
        div.innerHTML= i + ". "+ item[1];
        document.getElementById("div_words").appendChild(div);
        AddRememberItem(i);
      }
      else
      {
        alert("Something wrong:item[3]=" + item[3]);
      }
    }
}
function ShowPage(i)
{
    document.getElementById("itemcount").innerHTML = range["itemCount"] + "条,共" + GetPageCount() + "页，当前第" + i +"页";
    ShowItem(i*7,7);
}
function ShowPrev()
{
    currentpage--;
    if(currentpage<=0)
    {
        currentpage = 0;
    }
    ShowPage(currentpage);
}
function ShowNext()
{
    currentpage++;
    if(currentpage>=GetPageCount())
    {
        currentpage = GetPageCount();
    }
    ShowPage(currentpage);
}
</script>

</body>
</html>